<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <!-- Mirrored from www.setera.org/2011/12/27/deadlocked/ by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 09 Aug 2021 00:40:35 GMT -->
 <!-- Added by HTTrack -->
 <meta content="text/html;charset=utf-8" http-equiv="content-type"/>
 <!-- /Added by HTTrack -->
 <head profile="http://gmpg.org/xfn/11">
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="IE=EmulateIE7" http-equiv="X-UA-Compatible"/>
  <title>
   Et-Setera » Deadlocked
  </title>
  <link href="../../../../feed/index.html" rel="alternate" title="RSS 2.0 - all posts" type="application/rss+xml"/>
  <link href="../../../../comments/feed/index.html" rel="alternate" title="RSS 2.0 - all comments" type="application/rss+xml"/>
  <!-- style START -->
  <!-- default style -->
  <style media="screen" type="text/css">
   @import url( ../../../../wp-content/themes/inove/style.css);
  </style>
  <!-- for translations -->
  <!--[if IE]>
		<link rel="stylesheet" href="https://www.setera.org/wp-content/themes/inove/ie.css" type="text/css" media="screen" />
	<![endif]-->
  <!-- style END -->
  <!-- script START -->
  <script src="../../../../wp-content/themes/inove/js/base.js" type="text/javascript">
  </script>
  <script src="../../../../wp-content/themes/inove/js/menu.js" type="text/javascript">
  </script>
  <!-- script END -->
  <script type="text/javascript">
   window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"https:\/\/www.setera.org\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.24"}};
			!function(e,o,t){var a,n,r;function i(e){var t=o.createElement("script");t.src=e,t.type="text/javascript",o.getElementsByTagName("head")[0].appendChild(t)}for(r=Array("simple","flag","unicode8","diversity"),t.supports={everything:!0,everythingExceptFlag:!0},n=0;n<r.length;n++)t.supports[r[n]]=function(e){var t,a,n=o.createElement("canvas"),r=n.getContext&&n.getContext("2d"),i=String.fromCharCode;if(!r||!r.fillText)return!1;switch(r.textBaseline="top",r.font="600 32px Arial",e){case"flag":return r.fillText(i(55356,56806,55356,56826),0,0),3e3<n.toDataURL().length;case"diversity":return r.fillText(i(55356,57221),0,0),a=(t=r.getImageData(16,16,1,1).data)[0]+","+t[1]+","+t[2]+","+t[3],r.fillText(i(55356,57221,55356,57343),0,0),a!=(t=r.getImageData(16,16,1,1).data)[0]+","+t[1]+","+t[2]+","+t[3];case"simple":return r.fillText(i(55357,56835),0,0),0!==r.getImageData(16,16,1,1).data[0];case"unicode8":return r.fillText(i(55356,57135),0,0),0!==r.getImageData(16,16,1,1).data[0]}return!1}(r[n]),t.supports.everything=t.supports.everything&&t.supports[r[n]],"flag"!==r[n]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[r[n]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(a=function(){t.readyCallback()},o.addEventListener?(o.addEventListener("DOMContentLoaded",a,!1),e.addEventListener("load",a,!1)):(e.attachEvent("onload",a),o.attachEvent("onreadystatechange",function(){"complete"===o.readyState&&t.readyCallback()})),(a=t.source||{}).concatemoji?i(a.concatemoji):a.wpemoji&&a.twemoji&&(i(a.twemoji),i(a.wpemoji)))}(window,document,window._wpemojiSettings);
  </script>
  <style type="text/css">
   img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
  </style>
  <link href="../../../11/02/relinking-android-market-applications/index.html" rel="prev" title="Relinking Android Market Applications"/>
  <link href="../../../../2012/03/11/still-deadlocked/index.html" rel="next" title="Still Deadlocked"/>
  <meta content="WordPress 4.5.24" name="generator"/>
  <link href="index.html" rel="canonical"/>
  <link href="../../../../../wp.me/pxvXF-a8" rel="shortlink"/>
  <link href="../../../../wp-content/plugins/google-syntax-highlighter/Styles/SyntaxHighlighter.css" rel="stylesheet" type="text/css"/>
 </head>
 <body>
  <!-- wrap START -->
  <div id="wrap">
   <!-- container START -->
   <div id="container">
    <!-- header START -->
    <div id="header">
     <!-- banner START -->
     <!-- banner END -->
     <div id="caption">
      <h1 id="title">
       <a href="../../../../index.html">
        Et-Setera
       </a>
      </h1>
      <div id="tagline">
       Ramblings of a geek
      </div>
     </div>
     <div class="fixed">
     </div>
    </div>
    <!-- header END -->
    <!-- navigation START -->
    <div id="navigation">
     <!-- menus START -->
     <ul id="menus">
      <li class="page_item">
       <a class="home" href="../../../../index.html" title="Home">
        Home
       </a>
      </li>
      <li class="page_item page-item-2">
       <a href="../../../../about/index.html">
        About
       </a>
      </li>
      <li class="page_item page-item-39 page_item_has_children">
       <a href="../../../../projects/index.html">
        Projects
       </a>
       <ul class="children">
        <li class="page_item page-item-14">
         <a href="../../../../projects/socket-over-http-tunneling/index.html">
          Socket over HTTP Tunneling
         </a>
        </li>
        <li class="page_item page-item-17">
         <a href="../../../../projects/jmechanic/index.html">
          jMechanic
         </a>
        </li>
        <li class="page_item page-item-32">
         <a href="../../../../projects/eclipse-mobile-tools-for-java/index.html">
          Eclipse Mobile Tools for Java
         </a>
        </li>
        <li class="page_item page-item-53">
         <a href="../../../../projects/blackberry-bold-pppd-replacement/index.html">
          BlackBerry Bold PPPD Replacement
         </a>
        </li>
        <li class="page_item page-item-178 page_item_has_children">
         <a href="../../../../projects/zberry/index.html">
          ZBerry
         </a>
         <ul class="children">
          <li class="page_item page-item-185">
           <a href="../../../../projects/zberry/zberry-documentation/index.html">
            ZBerry Documentation
           </a>
          </li>
         </ul>
        </li>
        <li class="page_item page-item-441">
         <a href="../../../../projects/rockbox-tagcache-database-generator/index.html">
          Rockbox Tagcache Database Generator
         </a>
        </li>
        <li class="page_item page-item-8">
         <a href="../../../../projects/eclipseme/index.html">
          EclipseME
         </a>
        </li>
        <li class="page_item page-item-11">
         <a href="../../../../projects/zeeme/index.html">
          ZeeME
         </a>
        </li>
       </ul>
      </li>
      <li>
       <a class="lastmenu" href="javascript:void(0);">
       </a>
      </li>
     </ul>
     <!-- menus END -->
     <!-- searchbox START -->
     <script type="text/javascript">
      //<![CDATA[
	var searchbox = MGJS.$("searchbox");
	var searchtxt = MGJS.getElementsByClassName("textfield", "input", searchbox)[0];
	var searchbtn = MGJS.getElementsByClassName("button", "input", searchbox)[0];
	var tiptext = "Type text to search here...";
	if(searchtxt.value == "" || searchtxt.value == tiptext) {
		searchtxt.className += " searchtip";
		searchtxt.value = tiptext;
	}
	searchtxt.onfocus = function(e) {
		if(searchtxt.value == tiptext) {
			searchtxt.value = "";
			searchtxt.className = searchtxt.className.replace(" searchtip", "");
		}
	}
	searchtxt.onblur = function(e) {
		if(searchtxt.value == "") {
			searchtxt.className += " searchtip";
			searchtxt.value = tiptext;
		}
	}
	searchbtn.onclick = function(e) {
		if(searchtxt.value == "" || searchtxt.value == tiptext) {
			return false;
		}
	}
//]]>
     </script>
     <!-- searchbox END -->
     <div class="fixed">
     </div>
    </div>
    <!-- navigation END -->
    <!-- content START -->
    <div id="content">
     <!-- main START -->
     <div id="main">
      <div id="postpath">
       <a href="../../../../index.html" title="Go to homepage">
        Home
       </a>
       &gt;
       <a href="../../../../category/mobile/android/index.html" rel="category tag">
        Android
       </a>
       ,
       <a href="../../../../category/mobile/index.html" rel="category tag">
        Mobile
       </a>
       &gt; Deadlocked
      </div>
      <div class="post" id="post-628">
       <h2>
        Deadlocked
       </h2>
       <div class="info">
        <span class="date">
         December 27th, 2011
        </span>
        <span class="author">
         <a href="../../../../author/admin/index.html" rel="author" title="Posts by Craig Setera">
          Craig Setera
         </a>
        </span>
        <div class="fixed">
        </div>
       </div>
       <div class="content">
        <p>
         I recently started spending more time on my
         <a href="../../../09/04/clock-widget-project/index.html">
          Android Clock Widget Project
         </a>
         .  I’ve implemented some much needed caching of the SVG definitions, speeding performance of clock rendering substantially.  In addition, I’ve been working on building a nice graphical clock selector.  Unfortunately, this selector is causing me lots of frustration due to a race condition that keeps deadlocking the application’s UI thread.
         <br/>
         <span id="more-628">
         </span>
        </p>
        <p>
         Parsing and rendering the various SVG layers that make up each clock is a relatively expensive operation.  Locking up the user interface while doing these operations is bad design and leads the user to believe that the application may not working correctly.  What I’m attempting to do seems pretty simple on the surface.  The following screen capture shows the (partially working) goal:
        </p>
        <p>
         <a href="../../../../wp-content/uploads/2011/12/clocks.png">
          <img alt="Clock Skin Selector" class="aligncenter size-full wp-image-629" height="488" sizes="(max-width: 328px) 100vw, 328px" src="../../../../wp-content/uploads/2011/12/clocks.png" srcset="https://www.setera.org/wp-content/uploads/2011/12/clocks.png 328w, https://www.setera.org/wp-content/uploads/2011/12/clocks-201x300.png 201w" title="Clock Skin Selector" width="328"/>
         </a>
        </p>
        <p>
         The selector consists of two columns, an image of the clock on the left and the name of the clock on the right.  Using the standard ListActivity support, the goal is to show an indeterminate progress image in the left column until the layers have been loaded and rendered.  At that point, the animated progress image is hidden and the clock image is displayed.
        </p>
        <p>
         The implementation is simple in concept.  The list adapter subclasses the standard BaseAdapter implementation to provide an implementation of the
         <em>
          getView
         </em>
         method.  The
         <em>
          getView
         </em>
         method delegates loading of the clock’s image to an asynchronous task, keeping the user interface alive.  When the asynchronous task completes, it signals the adapter by calling
         <em>
          notifyDataSetChanged
         </em>
         .  The next call to
         <em>
          getView
         </em>
         will hide the progress animation and display the rendered image.
        </p>
        <p>
         While this is mostly working, I’m hitting a random deadlock condition that locks up the UI thread, usually resulting in an “Application Not Responding” (ANR) error message to the user.  All of my attempts to diagnose and resolve this issue have ended with nothing but frustration.  So far, I’ve tried all of the “standard” approaches to diagnose this:
        </p>
        <ul>
         <li>
          Analyzed the traces.txt file generated by the ANR.
          <br/>
          Unfortunately, the process never shows up in the log file.
         </li>
         <li>
          Force-generated a traces.txt file using
          <em>
           kill SIGQUIT pid
          </em>
          while the application was still running.
          <br/>
          Again, the process doesn’t seem to show up.  Instead, I see “W/dalvikvm(19144): threadid=4: spin on suspend #1 threadid=9 (pcf=0)” whenever attempting this.
         </li>
         <li>
          Attempted to use the standard Eclipse debugger to suspend the UI thread once it is locked up.
          <br/>
          No big surprise that it did not work.
         </li>
         <li>
          Added lots of Log output trying to pinpoint the hang.
          <br/>
          At least from that logging, it doesn’t
          <b>
           appear
          </b>
          to be a hang anywhere directly in my code.
         </li>
         <li>
          I even tried to use method tracing to see if I could figure anything out.
         </li>
        </ul>
        <p>
         At this point, I’ve run out of good ideas on how to track down and fix this problem on my own.  I’ve gone ahead and joined the Google android-developers group and asked for ideas on solving this.  I’m still waiting for my question to clear moderation to see if anyone else can offer any insights.  If anyone reading this has any ideas, I’d love to hear them.  Until then, this project is officially deadlocked.
        </p>
        <div class="fixed">
        </div>
       </div>
       <div class="under">
        <span class="categories">
         Categories:
        </span>
        <span>
         <a href="../../../../category/mobile/android/index.html" rel="category tag">
          Android
         </a>
         ,
         <a href="../../../../category/mobile/index.html" rel="category tag">
          Mobile
         </a>
        </span>
        <span class="tags">
         Tags:
        </span>
        <span>
        </span>
       </div>
      </div>
      <!-- related posts START -->
      <!-- related posts END -->
      <script src="../../../../wp-content/themes/inove/js/comment.js" type="text/javascript">
      </script>
      <div class="messagebox">
       Comments are closed.
      </div>
      <div id="postnavi">
       <span class="prev">
        <a href="../../../../2012/03/11/still-deadlocked/index.html" rel="next">
         Still Deadlocked
        </a>
       </span>
       <span class="next">
        <a href="../../../11/02/relinking-android-market-applications/index.html" rel="prev">
         Relinking Android Market Applications
        </a>
       </span>
       <div class="fixed">
       </div>
      </div>
     </div>
     <!-- main END -->
     <!-- sidebar START -->
     <div id="sidebar">
      <!-- sidebar north START -->
      <div class="sidebar" id="northsidebar">
       <!-- feeds -->
       <!-- showcase -->
       <!-- posts -->
       <div class="widget">
        <h3>
         Recent Posts
        </h3>
        <ul>
         <li>
          <a href="../../../../2013/11/14/android-native-libraries/index.html">
           Android Native Libraries In Root Context
          </a>
         </li>
         <li>
          <a href="../../../../2013/08/08/debugging-titanium-android-native-modules/index.html">
           Debugging Titanium Android Native Modules
          </a>
         </li>
         <li>
          <a href="../../../../2013/03/03/ubuntu-12-10-screen-brightness-on-sony-vaio-t15/index.html">
           Ubuntu 12.10 Screen Brightness on Sony VAIO T15
          </a>
         </li>
         <li>
          <a href="../../../../2012/09/10/pinpointing-android-locationmanagerservice-battery-drain/index.html">
           Pinpointing Android LocationManagerService Battery Drain
          </a>
         </li>
         <li>
          <a href="../../../../2012/07/01/eclipseme-lives/index.html">
           EclipseME Lives!
          </a>
         </li>
        </ul>
       </div>
       <!-- recent comments -->
       <!-- tag cloud -->
       <!--
	<div id="tag_cloud" class="widget">
		<h3>Tag Cloud</h3>
			</div>
-->
      </div>
      <!-- sidebar north END -->
      <div id="centersidebar">
       <!-- sidebar east START -->
       <div class="sidebar" id="eastsidebar">
        <!-- categories -->
        <div class="widget widget_categories">
         <h3>
          Categories
         </h3>
         <ul>
          <li class="cat-item cat-item-19">
           <a href="../../../../category/andengine/index.html">
            AndEngine
           </a>
          </li>
          <li class="cat-item cat-item-20">
           <a href="../../../../category/andpingus/index.html">
            AndPingus
           </a>
          </li>
          <li class="cat-item cat-item-25">
           <a href="../../../../category/appcelerator-titanium/index.html">
            Appcelerator Titanium
           </a>
          </li>
          <li class="cat-item cat-item-23">
           <a href="../../../../category/clock/index.html">
            Clock
           </a>
          </li>
          <li class="cat-item cat-item-3">
           <a href="../../../../category/eclipse/index.html">
            Eclipse
           </a>
          </li>
          <li class="cat-item cat-item-11">
           <a href="../../../../category/interactive-fiction/index.html">
            Interactive Fiction
           </a>
          </li>
          <li class="cat-item cat-item-10">
           <a href="../../../../category/macintosh/index.html">
            Macintosh
           </a>
          </li>
          <li class="cat-item cat-item-22">
           <a href="../../../../category/mfoundry/index.html">
            mFoundry
           </a>
          </li>
          <li class="cat-item cat-item-6">
           <a href="../../../../category/misc/index.html">
            Miscellaneous
           </a>
          </li>
          <li class="cat-item cat-item-7">
           <a href="../../../../category/mobile/index.html">
            Mobile
           </a>
          </li>
          <li class="cat-item cat-item-21">
           <a href="../../../../category/rockbox/index.html">
            Rockbox
           </a>
          </li>
          <li class="cat-item cat-item-12">
           <a href="../../../../category/software-development/index.html">
            Software Development
           </a>
          </li>
          <li class="cat-item cat-item-24">
           <a href="../../../../category/ubuntu/index.html">
            Ubuntu
           </a>
          </li>
          <li class="cat-item cat-item-1">
           <a href="../../../../category/uncategorized/index.html">
            Uncategorized
           </a>
          </li>
         </ul>
        </div>
       </div>
       <!-- sidebar east END -->
       <!-- sidebar west START -->
       <div class="sidebar" id="westsidebar">
        <!-- blogroll -->
        <div class="widget widget_links">
         <h3>
          Blogroll
         </h3>
         <ul>
          <li>
           <a href="http://www.eclipse.org/dsdp/mtj/">
            Eclipse Mobile Tools for Java
           </a>
          </li>
          <li>
           <a href="http://eclipseme.org/">
            EclipseME
           </a>
          </li>
          <li>
           <a href="http://mojax.mfoundry.com/">
            mFoundry mojax
           </a>
          </li>
          <li>
           <a href="http://www.mfoundry.com/">
            mFoundry, Inc.
           </a>
          </li>
         </ul>
        </div>
       </div>
       <!-- sidebar west END -->
       <div class="fixed">
       </div>
      </div>
      <!-- sidebar south START -->
      <div class="sidebar" id="southsidebar">
       <div class="widget widget_archive" id="archives-3">
        <h3>
         Archives
        </h3>
        <ul>
         <li>
          <a href="../../../../2013/11/index.html">
           November 2013
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2013/08/index.html">
           August 2013
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2013/03/index.html">
           March 2013
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2012/09/index.html">
           September 2012
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2012/07/index.html">
           July 2012
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2012/05/index.html">
           May 2012
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2012/03/index.html">
           March 2012
          </a>
          (1)
         </li>
         <li>
          <a href="../../index.html">
           December 2011
          </a>
          (1)
         </li>
         <li>
          <a href="../../../11/index.html">
           November 2011
          </a>
          (1)
         </li>
         <li>
          <a href="../../../10/index.html">
           October 2011
          </a>
          (1)
         </li>
         <li>
          <a href="../../../09/index.html">
           September 2011
          </a>
          (1)
         </li>
         <li>
          <a href="../../../07/index.html">
           July 2011
          </a>
          (1)
         </li>
         <li>
          <a href="../../../06/index.html">
           June 2011
          </a>
          (2)
         </li>
         <li>
          <a href="../../../05/index.html">
           May 2011
          </a>
          (2)
         </li>
         <li>
          <a href="../../../04/index.html">
           April 2011
          </a>
          (1)
         </li>
         <li>
          <a href="../../../03/index.html">
           March 2011
          </a>
          (2)
         </li>
         <li>
          <a href="../../../02/index.html">
           February 2011
          </a>
          (2)
         </li>
         <li>
          <a href="../../../01/index.html">
           January 2011
          </a>
          (2)
         </li>
         <li>
          <a href="../../../../2010/12/index.html">
           December 2010
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2010/11/index.html">
           November 2010
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2010/08/index.html">
           August 2010
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2010/04/index.html">
           April 2010
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2010/03/index.html">
           March 2010
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2009/10/index.html">
           October 2009
          </a>
          (1)
         </li>
         <li>
          <a href="../../../../2009/09/index.html">
           September 2009
          </a>
          (4)
         </li>
         <li>
          <a href="../../../../2009/08/index.html">
           August 2009
          </a>
          (2)
         </li>
         <li>
          <a href="../../../../2009/07/index.html">
           July 2009
          </a>
          (2)
         </li>
         <li>
          <a href="../../../../2009/06/index.html">
           June 2009
          </a>
          (6)
         </li>
         <li>
          <a href="../../../../2009/05/index.html">
           May 2009
          </a>
          (2)
         </li>
        </ul>
       </div>
      </div>
      <!-- sidebar south END -->
     </div>
     <!-- sidebar END -->
     <div class="fixed">
     </div>
    </div>
    <!-- content END -->
    <!-- footer START -->
    <div id="footer">
     <a href="#" id="gotop" onclick="MGJS.goTop();return false;">
      Top
     </a>
     <a href="http://wordpress.org/" id="powered">
      WordPress
     </a>
     <div id="copyright">
     </div>
    </div>
   </div>
  </div>
 </body>
</html>